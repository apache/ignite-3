<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="648px" preserveAspectRatio="none" style="width:2216px;height:648px;background:#FFFFFF;" version="1.1" viewBox="0 0 2216 648" width="2216px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="258" x="978.5" y="28.5352">General Rebalance Flow (diagram 1)</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="25" x2="25" y1="71.6211" y2="615.543"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="216" x2="216" y1="71.6211" y2="615.543"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="620" x2="620" y1="71.6211" y2="615.543"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1040.5" x2="1040.5" y1="71.6211" y2="615.543"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1404" x2="1404" y1="71.6211" y2="615.543"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1821.5" x2="1821.5" y1="71.6211" y2="615.543"/><rect fill="#E2E2F0" height="28.1328" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="40" x="5" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="26" x="12" y="61.0898">User</text><rect fill="#E2E2F0" height="28.1328" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="40" x="5" y="614.543"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="26" x="12" y="633.1445">User</text><rect fill="#E2E2F0" height="28.1328" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156" x="138" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="142" x="145" y="61.0898">DistributionConfiguration</text><rect fill="#E2E2F0" height="28.1328" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156" x="138" y="614.543"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="142" x="145" y="633.1445">DistributionConfiguration</text><rect fill="#E2E2F0" height="28.1328" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="158" x="541" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="144" x="548" y="61.0898">DistributionZoneManager</text><rect fill="#E2E2F0" height="28.1328" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="158" x="541" y="614.543"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="144" x="548" y="633.1445">DistributionZoneManager</text><rect fill="#E2E2F0" height="28.1328" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="1005.5" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="57" x="1012.5" y="61.0898">Metastore</text><rect fill="#E2E2F0" height="28.1328" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="1005.5" y="614.543"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="57" x="1012.5" y="633.1445">Metastore</text><rect fill="#E2E2F0" height="28.1328" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108" x="1350" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="94" x="1357" y="61.0898">PlacementDriver</text><rect fill="#E2E2F0" height="28.1328" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108" x="1350" y="614.543"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="94" x="1357" y="633.1445">PlacementDriver</text><rect fill="#E2E2F0" height="28.1328" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="147" x="1748.5" y="42.4883"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="133" x="1755.5" y="61.0898">PartitionPrimaryReplica</text><rect fill="#E2E2F0" height="28.1328" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="147" x="1748.5" y="614.543"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="133" x="1755.5" y="633.1445">PartitionPrimaryReplica</text><polygon fill="#181818" points="204,97.7539,214,101.7539,204,105.7539,208,101.7539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="25" x2="210" y1="101.7539" y2="101.7539"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="43" x="32" y="97.2227">Change</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="75" y="97.2227"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="7" x="79" y="97.2227">a</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="86" y="97.2227"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="45" x="90" y="97.2227">number</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="135" y="97.2227"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="11" x="139" y="97.2227">of</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="150" y="97.2227"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="45" x="154" y="97.2227">replicas</text><polygon fill="#181818" points="608,125.8867,618,129.8867,608,133.8867,612,129.8867" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="216" x2="614" y1="129.8867" y2="129.8867"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="50" x="223" y="125.3555">Receives</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="273" y="125.3555"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="14" x="277" y="125.3555">an</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="291" y="125.3555"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="41" x="295" y="125.3555">update</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="336" y="125.3555"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="44" x="340" y="125.3555">through</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="384" y="125.3555"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="18" x="388" y="125.3555">the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="406" y="125.3555"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="65" x="410" y="125.3555">distribution</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="475" y="125.3555"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="74" x="479" y="125.3555">configuration</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="553" y="125.3555"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="46" x="557" y="125.3555">listener.</text><polygon fill="#181818" points="1029,199.418,1039,203.418,1029,207.418,1033,203.418" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="620" x2="1035" y1="203.418" y2="203.418"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="52" x="627" y="170.6211">Calculate</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="679" y="170.6211"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="23" x="683" y="170.6211">new</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="706" y="170.6211"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="71" x="710" y="170.6211">assignments</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="781" y="170.6211"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="36" x="785" y="170.6211">based</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="821" y="170.6211"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="14" x="825" y="170.6211">on</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="839" y="170.6211"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="18" x="843" y="170.6211">the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="861" y="170.6211"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="41" x="865" y="170.6211">current</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="906" y="170.6211"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="61" x="910" y="170.6211">datanodes</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="971" y="170.6211"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="22" x="975" y="170.6211">and</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="997" y="170.6211"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="19" x="1001" y="170.6211">put</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="18" x="627" y="184.7539">the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="645" y="184.7539"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="32" x="649" y="184.7539">result</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="681" y="184.7539"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="11" x="685" y="184.7539">of</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="696" y="184.7539"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="66" x="700" y="184.7539">calculations</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="766" y="184.7539"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="11" x="770" y="184.7539">to</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="781" y="184.7539"> </text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="179" x="785" y="184.7539">zoneId.assignments.pending</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="6" x="964" y="184.7539">/</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="50" x="970" y="184.7539">planned</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="627" y="198.8867">key</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="647" y="198.8867"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="24" x="651" y="198.8867">[see</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="675" y="198.8867"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="12" x="679" y="198.8867">1]</text><path d="M218,142.8867 L218,222.8867 L615,222.8867 L615,152.8867 L605,142.8867 L218,142.8867 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M605,142.8867 L605,152.8867 L615,152.8867 L605,142.8867 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="256" x="224" y="159.4883">this put must be covered by the similar logic</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="225" x="224" y="173.6211">which we have in the current rebalance</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="286" x="224" y="187.7539">to prevent the metastore call from multiple nodes</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="376" x="224" y="201.8867">due to the fact, because each node has DistributionZoneManager</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="191" x="224" y="216.0195">and listens configuration updates</text><polygon fill="#181818" points="631,258.8164,621,262.8164,631,266.8164,627,262.8164" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="625" x2="1040" y1="262.8164" y2="262.8164"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="50" x="637" y="244.1523">Receives</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="687" y="244.1523"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="14" x="691" y="244.1523">an</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="705" y="244.1523"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="41" x="709" y="244.1523">update</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="750" y="244.1523"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="11" x="754" y="244.1523">of</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="765" y="244.1523"> </text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="179" x="769" y="244.1523">zoneId.assignments.pending</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="948" y="244.1523"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="952" y="244.1523">key</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="972" y="244.1523"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="22" x="976" y="244.1523">and</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="998" y="244.1523"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="32" x="1002" y="244.1523">starts</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39" x="637" y="258.2852">replica</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="676" y="258.2852"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="36" x="680" y="258.2852">server</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="716" y="258.2852"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="7" x="720" y="258.2852">if</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="727" y="258.2852"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="44" x="731" y="258.2852">needed</text><polygon fill="#181818" points="1392,286.9492,1402,290.9492,1392,294.9492,1396,290.9492" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1041" x2="1398" y1="290.9492" y2="290.9492"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="50" x="1048" y="286.418">Receives</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1098" y="286.418"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="14" x="1102" y="286.418">an</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1116" y="286.418"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="41" x="1120" y="286.418">update</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1161" y="286.418"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="11" x="1165" y="286.418">of</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1176" y="286.418"> </text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="179" x="1180" y="286.418">zoneId.assignments.pending</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1359" y="286.418"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="24" x="1363" y="286.418">key.</text><polygon fill="#181818" points="1810,329.2148,1820,333.2148,1810,337.2148,1814,333.2148" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1404" x2="1816" y1="333.2148" y2="333.2148"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="28" x="1411" y="314.5508">Send</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1439" y="314.5508"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="7" x="1443" y="314.5508">a</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1450" y="314.5508"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="107" x="1454" y="314.5508">RebalanceRequest</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1561" y="314.5508"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="11" x="1565" y="314.5508">to</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1576" y="314.5508"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="86" x="1580" y="314.5508">PrimaryReplica</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1666" y="314.5508"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="16" x="1670" y="314.5508">for</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1686" y="314.5508"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="18" x="1690" y="314.5508">the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1708" y="314.5508"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="57" x="1712" y="314.5508">rebalance</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1769" y="314.5508"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="11" x="1773" y="314.5508">of</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1784" y="314.5508"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="13" x="1788" y="314.5508">its</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="1411" y="328.6836">group</text><line style="stroke:#181818;stroke-width:1.0;" x1="1822" x2="1864" y1="361.3477" y2="361.3477"/><line style="stroke:#181818;stroke-width:1.0;" x1="1864" x2="1864" y1="361.3477" y2="374.3477"/><line style="stroke:#181818;stroke-width:1.0;" x1="1823" x2="1864" y1="374.3477" y2="374.3477"/><polygon fill="#181818" points="1833,370.3477,1823,374.3477,1833,378.3477,1829,374.3477" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="31" x="1829" y="356.8164">Await</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1860" y="356.8164"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="16" x="1864" y="356.8164">for</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1880" y="356.8164"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="13" x="1884" y="356.8164">all</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1897" y="356.8164"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="45" x="1901" y="356.8164">replicas</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1946" y="356.8164"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="26" x="1950" y="356.8164">start</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1976" y="356.8164"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="24" x="1980" y="356.8164">[see</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="2004" y="356.8164"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="12" x="2008" y="356.8164">2]</text><line style="stroke:#181818;stroke-width:1.0;" x1="1822" x2="1864" y1="402.4805" y2="402.4805"/><line style="stroke:#181818;stroke-width:1.0;" x1="1864" x2="1864" y1="402.4805" y2="415.4805"/><line style="stroke:#181818;stroke-width:1.0;" x1="1823" x2="1864" y1="415.4805" y2="415.4805"/><polygon fill="#181818" points="1833,411.4805,1823,415.4805,1833,419.4805,1829,415.4805" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="44" x="1829" y="397.9492">Process</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1873" y="397.9492"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="1877" y="397.9492">replication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1937" y="397.9492"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="1941" y="397.9492">group</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1975" y="397.9492"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="41" x="1979" y="397.9492">update</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="2020" y="397.9492"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="24" x="2024" y="397.9492">[see</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="2048" y="397.9492"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="8" x="2052" y="397.9492">3</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="2060" y="397.9492"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="22" x="2064" y="397.9492">and</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="2086" y="397.9492"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="51" x="2090" y="397.9492">separate</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="2141" y="397.9492"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="48" x="2145" y="397.9492">diagram</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="2193" y="397.9492"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="12" x="2197" y="397.9492">2]</text><polygon fill="#181818" points="1415,453.7461,1405,457.7461,1415,461.7461,1411,457.7461" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1409" x2="1821" y1="457.7461" y2="457.7461"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="33" x="1421" y="439.082">Notify</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1454" y="439.082"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="33" x="1458" y="439.082">about</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1491" y="439.082"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="57" x="1495" y="439.082">rebalance</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1552" y="439.082"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="33" x="1556" y="439.082">done.</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1589" y="439.082"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="94" x="1593" y="439.082">PlacementDriver</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1687" y="439.082"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="47" x="1691" y="439.082">updates</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1738" y="439.082"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="36" x="1742" y="439.082">itself's</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1778" y="439.082"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="33" x="1782" y="439.082">cache</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="16" x="1421" y="453.2148">for</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1437" y="453.2148"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="65" x="1441" y="453.2148">rebalanced</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1506" y="453.2148"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="1510" y="453.2148">group</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1544" y="453.2148"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="23" x="1548" y="453.2148">with</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1571" y="453.2148"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="18" x="1575" y="453.2148">the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1593" y="453.2148"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="1597" y="453.2148">addresses</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1657" y="453.2148"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="11" x="1661" y="453.2148">of</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1672" y="453.2148"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="18" x="1676" y="453.2148">the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1694" y="453.2148"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="23" x="1698" y="453.2148">new</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1721" y="453.2148"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="59" x="1725" y="453.2148">members.</text><polygon fill="#181818" points="1052,481.8789,1042,485.8789,1052,489.8789,1048,485.8789" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1046" x2="1403" y1="485.8789" y2="485.8789"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="18" x="1058" y="481.3477">Put</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1076" y="481.3477"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="18" x="1080" y="481.3477">the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1098" y="481.3477"> </text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="166" x="1102" y="481.3477">zoneId.assignments.stable</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1268" y="481.3477"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="1272" y="481.3477">key</text><polygon fill="#181818" points="631,538.2773,621,542.2773,631,546.2773,627,542.2773" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="625" x2="1040" y1="542.2773" y2="542.2773"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="50" x="637" y="509.4805">Receives</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="687" y="509.4805"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="18" x="691" y="509.4805">the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="709" y="509.4805"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="41" x="713" y="509.4805">update</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="754" y="509.4805"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="33" x="758" y="509.4805">about</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="791" y="509.4805"> </text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="166" x="795" y="509.4805">zoneId.assignments.stable</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="961" y="509.4805"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="41" x="965" y="509.4805">update</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1006" y="509.4805"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="22" x="1010" y="509.4805">and</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="25" x="637" y="523.6133">stop</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="662" y="523.6133"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="18" x="666" y="523.6133">the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="684" y="523.6133"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="58" x="688" y="523.6133">unneeded</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="746" y="523.6133"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="60" x="750" y="523.6133">replication</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="810" y="523.6133"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="34" x="814" y="523.6133">group</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="848" y="523.6133"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="55" x="852" y="523.6133">members</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="907" y="523.6133"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="14" x="911" y="523.6133">on</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="925" y="523.6133"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="18" x="929" y="523.6133">the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="947" y="523.6133"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="41" x="951" y="523.6133">current</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="992" y="523.6133"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="33" x="996" y="523.6133">node,</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="7" x="637" y="537.7461">if</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="644" y="537.7461"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="44" x="648" y="537.7461">needed</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="692" y="537.7461"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="24" x="696" y="537.7461">[see</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="720" y="537.7461"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="12" x="724" y="537.7461">4]</text><line style="stroke:#181818;stroke-width:1.0;" x1="620" x2="662" y1="584.543" y2="584.543"/><line style="stroke:#181818;stroke-width:1.0;" x1="662" x2="662" y1="584.543" y2="597.543"/><line style="stroke:#181818;stroke-width:1.0;" x1="621" x2="662" y1="597.543" y2="597.543"/><polygon fill="#181818" points="631,593.543,621,597.543,631,601.543,627,597.543" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="35" x="627" y="565.8789">Check</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="662" y="565.8789"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="7" x="666" y="565.8789">if</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="673" y="565.8789"> </text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" textLength="178" x="677" y="565.8789">zoneId.assignments.planned</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="855" y="565.8789"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="20" x="859" y="565.8789">key</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="879" y="565.8789"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="9" x="883" y="565.8789">is</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="892" y="565.8789"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="36" x="896" y="565.8789">empty</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="932" y="565.8789"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="22" x="936" y="565.8789">and</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="958" y="565.8789"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="26" x="962" y="565.8789">start</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="988" y="565.8789"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="23" x="992" y="565.8789">new</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="57" x="627" y="580.0117">rebalance</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="684" y="580.0117"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="7" x="688" y="580.0117">if</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="695" y="580.0117"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="18" x="699" y="580.0117">not</text><!--SRC=[fLJ1Rjim3BthAtZRPhHPs_NKGu6XHOSTEWGfTjdG0stHjb1PyYGvMVlr8ssdSTAaGxTJ44jwV7plaSaaI_2570MqiA0SBRg2uCRw5RpN1gk03Pn-K2e-6DUY_6lmzot5Y1NTcIU2yvEJoQ6c4ZkRRhnB_UdfcLBV8mKuleHh4rCmUPUCTrVUbQRg0ieVk82h6br5WE2w9kVhleH0hJK5HgKEFppUWVtX7TsYOsw1GHTKa5bI17JGjHeJGQg3xwgQVmdqv24KMxYMZqIKsNRnAJnNlgM4CVb0qW3QehDImj4AC4PJkOPSYf1Z90qCAZMBBWJ-2am6dTSzDmrjb_hJG975a-QB4OwBHaWUiko9Qt_Limdoh2MdZQkox6EMjMoS8vrby42Fy3CIQt-ld6T2bigaKcrYNwVfOeAScVWb1IQMF_QbescCnG3MLwPGgzeKDQm8QbmIc6tkOHqJnSJQG4lvA1UQPpsOleKoU4uBDsHQ3bdVhT8TIJjokyGY7J6J0hj8GCW5vGwNZ8SyLIBMu4tSSMpmDogM1AHhfJRkl3abRC3hWlSY2vcOCB37OrQ1aywgWYav1QH9xv2OMon8eAw3MVvNyPdQnH9uvcAamNam3OR7nSZg0kv45jmC-89-TSGvO2jsxfO-Z55SxmBcOxZ5YWUdLOTA7Av-0PzNQ58FBAbOZ_KWtP3Ki_j_0EQsvi4Nl8hMc7qGUfvhBNlqJuDJ91igoTWFM-qlHLzOzSqdKxBhkUycCm2QdPgzk3x6KPGZMxxZj7A-gHVX-QaUkQvC6XOIQiqR8F8prbm-o2ffI1PYt6luT07DnnsoDpkiTMvfYCxR1qDWHq67xb-liRxQZuTlX-Tk68WzLeqDxcv8sGL7cqaQh3o_VsqV7sxbggRYGS3sJzRMxkGzIKsR9lFT-x1nN3Zvz0S0]--></g></svg>