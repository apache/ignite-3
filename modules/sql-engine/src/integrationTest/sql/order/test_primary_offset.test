# name: test/sql/order/test_primary_offset.test
# description: F863: Nested <result offset clause>. Top-level <result offset clause> in <query expression> <query expression>
# group: [order]

statement ok
CREATE TABLE test (a INTEGER);

statement ok
INSERT INTO test VALUES (1), (2), (3), (4)

query I rowsort
SELECT a FROM
  (SELECT a FROM test ORDER BY a OFFSET 2) t(a)
UNION ALL
  SELECT a FROM test
----
1
2
3
3
4
4

query I rowsort
SELECT a FROM test
UNION ALL
SELECT a FROM
  (SELECT a FROM test ORDER BY a OFFSET 2) t(a)
----
1
2
3
3
4
4

query I rowsort
SELECT a FROM
  (SELECT a FROM test ORDER BY a LIMIT 1 OFFSET 1) t(a)
UNION ALL
SELECT a FROM
  (SELECT a FROM
    (SELECT a FROM test ORDER BY a LIMIT 3 OFFSET 2) i(a)
    ORDER BY a OFFSET 1
  ) t(a)
----
2
4

query I rowsort
SELECT a FROM
  (SELECT a FROM test ORDER BY a OFFSET 2) t(a)
UNION ALL
SELECT a FROM
  (SELECT a FROM
    (SELECT a FROM test ORDER BY a OFFSET 2) i(a)
    ORDER BY a OFFSET 3
  ) t(a)
----
3
4

query I rowsort
SELECT a FROM test
UNION ALL
SELECT a FROM
  (SELECT a FROM
    (SELECT a FROM test ORDER BY a OFFSET 2) i(a)
    ORDER BY a OFFSET 3
  ) t(a)
----
1
2
3
4
