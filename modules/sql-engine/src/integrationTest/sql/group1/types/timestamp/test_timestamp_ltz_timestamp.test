# name: test/sql/types/timestamp/test_timestamp_ltz_timestamp.test
# description: Test TIMESTAMP WITH LOCAL TIME ZONE TIMESTAMP compatibility
# group: [timestamp]

statement ok
PRAGMA enable_verification

statement ok
PRAGMA time_zone=Europe/Paris

# Timestamp_ltz into Timestamp

statement ok
CREATE TABLE timestamp_t(id INT PRIMARY KEY, t1_0 TIMESTAMP(0), t1_1 TIMESTAMP(1), t1_2 TIMESTAMP(2), t1_3 TIMESTAMP(3))

statement ok
INSERT INTO timestamp_t VALUES(1, TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:00.333', TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:00.333', TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:00.333', TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:00.333')

statement ok
INSERT INTO timestamp_t VALUES(2, TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:00.999', TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:00.999', TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:00.999', TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:00.999')

statement ok
INSERT INTO timestamp_t VALUES(3, TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:59.333', TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:59.333', TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:59.333', TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:59.333')

statement ok
INSERT INTO timestamp_t VALUES(4, TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:59.999', TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:59.999', TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:59.999', TIMESTAMP WITH LOCAL TIME ZONE '2008-04-03 00:00:59.999')

query TTTT
SELECT t1_0::VARCHAR, t1_1::VARCHAR, t1_2::VARCHAR, t1_3::VARCHAR FROM timestamp_t ORDER BY id ASC
----
2008-04-03 00:00:00	2008-04-03 00:00:00.3	2008-04-03 00:00:00.33	2008-04-03 00:00:00.333
2008-04-03 00:00:00	2008-04-03 00:00:00.9	2008-04-03 00:00:00.99	2008-04-03 00:00:00.999
2008-04-03 00:00:59	2008-04-03 00:00:59.3	2008-04-03 00:00:59.33	2008-04-03 00:00:59.333
2008-04-03 00:00:59	2008-04-03 00:00:59.9	2008-04-03 00:00:59.99	2008-04-03 00:00:59.999

statement ok
DROP TABLE timestamp_t

# Timestamp into Timestamp_ltz

statement ok
CREATE TABLE timestamp_ltz_t(id INT PRIMARY KEY, t1_0 TIMESTAMP(0) WITH LOCAL TIME ZONE, t1_1 TIMESTAMP(1) WITH LOCAL TIME ZONE, t1_2 TIMESTAMP(2) WITH LOCAL TIME ZONE, t1_3 TIMESTAMP(3) WITH LOCAL TIME ZONE)

statement ok
INSERT INTO timestamp_ltz_t VALUES(1, TIMESTAMP '2008-04-03 00:00:00.333', TIMESTAMP '2008-04-03 00:00:00.333', TIMESTAMP '2008-04-03 00:00:00.333', TIMESTAMP '2008-04-03 00:00:00.333')

statement ok
INSERT INTO timestamp_ltz_t VALUES(2, TIMESTAMP '2008-04-03 00:00:00.999', TIMESTAMP '2008-04-03 00:00:00.999', TIMESTAMP '2008-04-03 00:00:00.999', TIMESTAMP '2008-04-03 00:00:00.999')

statement ok
INSERT INTO timestamp_ltz_t VALUES(3, TIMESTAMP '2008-04-03 00:00:59.333', TIMESTAMP '2008-04-03 00:00:59.333', TIMESTAMP '2008-04-03 00:00:59.333', TIMESTAMP '2008-04-03 00:00:59.333')

statement ok
INSERT INTO timestamp_ltz_t VALUES(4, TIMESTAMP '2008-04-03 00:00:59.999', TIMESTAMP '2008-04-03 00:00:59.999', TIMESTAMP '2008-04-03 00:00:59.999', TIMESTAMP '2008-04-03 00:00:59.999')

query TTTT
SELECT t1_0::VARCHAR, t1_1::VARCHAR, t1_2::VARCHAR, t1_3::VARCHAR FROM timestamp_ltz_t ORDER BY id ASC
----
2008-04-03 00:00:00 Europe/Paris	2008-04-03 00:00:00.3 Europe/Paris	2008-04-03 00:00:00.33 Europe/Paris	2008-04-03 00:00:00.333 Europe/Paris
2008-04-03 00:00:00 Europe/Paris	2008-04-03 00:00:00.9 Europe/Paris	2008-04-03 00:00:00.99 Europe/Paris	2008-04-03 00:00:00.999 Europe/Paris
2008-04-03 00:00:59 Europe/Paris	2008-04-03 00:00:59.3 Europe/Paris	2008-04-03 00:00:59.33 Europe/Paris	2008-04-03 00:00:59.333 Europe/Paris
2008-04-03 00:00:59 Europe/Paris	2008-04-03 00:00:59.9 Europe/Paris	2008-04-03 00:00:59.99 Europe/Paris	2008-04-03 00:00:59.999 Europe/Paris
