# name: test/sql/insert/test_insert_type.test
# description: Test insert into from wrong type
# group: [insert]

statement ok
CREATE TABLE strings(a VARCHAR)

statement ok
CREATE TABLE integers(i INTEGER)

statement ok
INSERT INTO integers VALUES (3), (4), (NULL)

statement ok
INSERT INTO strings SELECT * FROM integers

query T
SELECT * FROM strings ORDER BY 1
----
3
4
NULL

statement ok
UPDATE strings SET a=13 WHERE a=3

query T
SELECT * FROM strings ORDER BY cast(a AS INTEGER)
----
4
13
NULL

statement ok
CREATE TABLE t8(id int, i TINYINT);

statement ok
CREATE TABLE t16(id int, i SMALLINT);

statement ok
CREATE TABLE t32(id int, i INTEGER);

statement ok
CREATE TABLE t64(id int, i BIGINT);

statement ok
INSERT INTO t8 VALUES(1, -128);

statement ok
INSERT INTO t16 VALUES(1, -32768);

statement ok
INSERT INTO t32 VALUES(1, -2147483648);

statement ok
INSERT INTO t64 VALUES(1, -9223372036854775808);

#Multiply

statement ok
INSERT INTO t16 VALUES(2, (SELECT i*i FROM t8 WHERE id=1));

query T
SELECT i FROM t16 WHERE id=2;
----
16384

statement ok
INSERT INTO t16 VALUES(21, (SELECT i*i*id::BIGINT FROM t8 WHERE id=1));

query T
SELECT i FROM t16 WHERE id=21;
----
16384

statement ok
INSERT INTO t32 VALUES(2, (SELECT i*i FROM t16 WHERE id=1));

query T
SELECT i FROM t32 WHERE id=2;
----
1073741824

statement ok
INSERT INTO t64 VALUES(2, (SELECT i*i FROM t32 WHERE id=1));

query T
SELECT i FROM t64 WHERE id=2;
----
4611686018427387904

#Divide

statement ok
INSERT INTO t16 VALUES(3, (SELECT i/-1 FROM t8 WHERE id=1));

query T
SELECT i FROM t16 WHERE id=3;
----
128

statement ok
INSERT INTO t32 VALUES(3, (SELECT i/-1 FROM t16 WHERE id=1));

query T
SELECT i FROM t32 WHERE id=3;
----
32768

statement ok
INSERT INTO t64 VALUES(3, (SELECT i/-1 FROM t32 WHERE id=1));

query T
SELECT i FROM t64 WHERE id=3;
----
2147483648

#Add

statement ok
INSERT INTO t16 VALUES(4, (SELECT i+i FROM t8 WHERE id=1));

query T
SELECT i FROM t16 WHERE id=4;
----
-256

statement ok
INSERT INTO t32 VALUES(4, (SELECT i+i FROM t16 WHERE id=1));

query T
SELECT i FROM t32 WHERE id=4;
----
-65536

statement ok
INSERT INTO t64 VALUES(4, (SELECT i+i FROM t32 WHERE id=1));

query T
SELECT i FROM t64 WHERE id=4;
----
-4294967296

#Subtract

statement ok
INSERT INTO t16 VALUES(5, (SELECT i-1 FROM t8 WHERE id=1));

query T
SELECT i FROM t16 WHERE id=5;
----
-129

statement ok
INSERT INTO t32 VALUES(5, (SELECT i-1 FROM t16 WHERE id=1));

query T
SELECT i FROM t32 WHERE id=5;
----
-32769

statement ok
INSERT INTO t64 VALUES(5, (SELECT i-1 FROM t32 WHERE id=1));

query T
SELECT i FROM t64 WHERE id=5;
----
-2147483649

