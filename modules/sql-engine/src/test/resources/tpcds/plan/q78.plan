Sort
    collation: [SS_CUSTOMER_SK ASC, STORE_QTY DESC, STORE_WHOLESALE_COST DESC, STORE_SALES_PRICE DESC, OTHER_CHAN_QTY ASC, OTHER_CHAN_WHOLESALE_COST ASC, OTHER_CHAN_SALES_PRICE ASC, RATIO ASC]
    fetch: 100
  Project
      fieldNames: [SS_CUSTOMER_SK, RATIO, STORE_QTY, STORE_WHOLESALE_COST, STORE_SALES_PRICE, OTHER_CHAN_QTY, OTHER_CHAN_WHOLESALE_COST, OTHER_CHAN_SALES_PRICE]
      projection: [SS_CUSTOMER_SK, ROUND(/(SS_QTY, +(CASE(IS NOT NULL(WS_QTY), CAST(WS_QTY):BIGINT NOT NULL, 0:BIGINT), CASE(IS NOT NULL(CS_QTY), CAST(CS_QTY):BIGINT NOT NULL, 0:BIGINT))), 2), SS_QTY, SS_WC, SS_SP, +(CASE(IS NOT NULL(WS_QTY), CAST(WS_QTY):BIGINT NOT NULL, 0:BIGINT), CASE(IS NOT NULL(CS_QTY), CAST(CS_QTY):BIGINT NOT NULL, 0:BIGINT)), +(CASE(IS NOT NULL(WS_WC), CAST(WS_WC):DECIMAL(32767, 2) NOT NULL, 0.00:DECIMAL(32767, 2)), CASE(IS NOT NULL(CS_WC), CAST(CS_WC):DECIMAL(32767, 2) NOT NULL, 0.00:DECIMAL(32767, 2))), +(CASE(IS NOT NULL(WS_SP), CAST(WS_SP):DECIMAL(32767, 2) NOT NULL, 0.00:DECIMAL(32767, 2)), CASE(IS NOT NULL(CS_SP), CAST(CS_SP):DECIMAL(32767, 2) NOT NULL, 0.00:DECIMAL(32767, 2)))]
    Filter
        predicate: OR(CASE(IS NOT NULL(WS_QTY), >(CAST(WS_QTY):BIGINT NOT NULL, 0), false), CASE(IS NOT NULL(CS_QTY), >(CAST(CS_QTY):BIGINT NOT NULL, 0), false))
      MergeJoin
          predicate: AND(=(CS_SOLD_YEAR, SS_SOLD_YEAR), =(CS_ITEM_SK, SS_ITEM_SK), =(CS_CUSTOMER_SK, SS_CUSTOMER_SK))
          type: left
        MergeJoin
            predicate: AND(=(WS_SOLD_YEAR, SS_SOLD_YEAR), =(WS_ITEM_SK, SS_ITEM_SK), =(WS_CUSTOMER_SK, SS_CUSTOMER_SK))
            type: left
          Sort
              collation: [SS_SOLD_YEAR ASC, SS_ITEM_SK ASC, SS_CUSTOMER_SK ASC]
            ColocatedHashAggregate
                fieldNames: [SS_SOLD_YEAR, SS_ITEM_SK, SS_CUSTOMER_SK, SS_QTY, SS_WC, SS_SP]
                group: [SS_SOLD_YEAR, SS_ITEM_SK, SS_CUSTOMER_SK]
                aggregation: [SUM(SS_QUANTITY), SUM(SS_WHOLESALE_COST), SUM(SS_SALES_PRICE)]
              Project
                  fieldNames: [SS_SOLD_YEAR, SS_ITEM_SK, SS_CUSTOMER_SK, SS_QUANTITY, SS_WHOLESALE_COST, SS_SALES_PRICE]
                  projection: [D_YEAR, SS_ITEM_SK, SS_CUSTOMER_SK, SS_QUANTITY, SS_WHOLESALE_COST, SS_SALES_PRICE]
                HashJoin
                    predicate: =(SS_SOLD_DATE_SK, D_DATE_SK)
                    type: inner
                  Filter
                      predicate: IS NULL(SR_TICKET_NUMBER)
                    HashJoin
                        predicate: AND(=(SR_TICKET_NUMBER, SS_TICKET_NUMBER), =(SS_ITEM_SK, SR_ITEM_SK))
                        type: left
                      Exchange
                          distribution: single
                        TableScan
                            table: PUBLIC.STORE_SALES
                            fieldNames: [SS_SOLD_DATE_SK, SS_ITEM_SK, SS_CUSTOMER_SK, SS_TICKET_NUMBER, SS_QUANTITY, SS_WHOLESALE_COST, SS_SALES_PRICE]
                      Exchange
                          distribution: single
                        TableScan
                            table: PUBLIC.STORE_RETURNS
                            fieldNames: [SR_ITEM_SK, SR_TICKET_NUMBER]
                  Exchange
                      distribution: single
                    TableScan
                        table: PUBLIC.DATE_DIM
                        predicate: =(D_YEAR, 2001)
                        fieldNames: [D_DATE_SK, D_YEAR]
          Sort
              collation: [WS_SOLD_YEAR ASC, WS_ITEM_SK ASC, WS_CUSTOMER_SK ASC]
            ColocatedHashAggregate
                fieldNames: [WS_SOLD_YEAR, WS_ITEM_SK, WS_CUSTOMER_SK, WS_QTY, WS_WC, WS_SP]
                group: [WS_SOLD_YEAR, WS_ITEM_SK, WS_CUSTOMER_SK]
                aggregation: [SUM(WS_QUANTITY), SUM(WS_WHOLESALE_COST), SUM(WS_SALES_PRICE)]
              Project
                  fieldNames: [WS_SOLD_YEAR, WS_ITEM_SK, WS_CUSTOMER_SK, WS_QUANTITY, WS_WHOLESALE_COST, WS_SALES_PRICE]
                  projection: [D_YEAR, WS_ITEM_SK, WS_BILL_CUSTOMER_SK, WS_QUANTITY, WS_WHOLESALE_COST, WS_SALES_PRICE]
                HashJoin
                    predicate: =(WS_SOLD_DATE_SK, D_DATE_SK)
                    type: inner
                  Filter
                      predicate: IS NULL(WR_ORDER_NUMBER)
                    HashJoin
                        predicate: AND(=(WR_ORDER_NUMBER, WS_ORDER_NUMBER), =(WS_ITEM_SK, WR_ITEM_SK))
                        type: left
                      Exchange
                          distribution: single
                        TableScan
                            table: PUBLIC.WEB_SALES
                            fieldNames: [WS_SOLD_DATE_SK, WS_ITEM_SK, WS_BILL_CUSTOMER_SK, WS_ORDER_NUMBER, WS_QUANTITY, WS_WHOLESALE_COST, WS_SALES_PRICE]
                      Exchange
                          distribution: single
                        TableScan
                            table: PUBLIC.WEB_RETURNS
                            fieldNames: [WR_ITEM_SK, WR_ORDER_NUMBER]
                  Exchange
                      distribution: single
                    TableScan
                        table: PUBLIC.DATE_DIM
                        fieldNames: [D_DATE_SK, D_YEAR]
        Sort
            collation: [CS_SOLD_YEAR ASC, CS_ITEM_SK ASC, CS_CUSTOMER_SK ASC]
          ColocatedHashAggregate
              fieldNames: [CS_SOLD_YEAR, CS_ITEM_SK, CS_CUSTOMER_SK, CS_QTY, CS_WC, CS_SP]
              group: [CS_SOLD_YEAR, CS_ITEM_SK, CS_CUSTOMER_SK]
              aggregation: [SUM(CS_QUANTITY), SUM(CS_WHOLESALE_COST), SUM(CS_SALES_PRICE)]
            Project
                fieldNames: [CS_SOLD_YEAR, CS_ITEM_SK, CS_CUSTOMER_SK, CS_QUANTITY, CS_WHOLESALE_COST, CS_SALES_PRICE]
                projection: [D_YEAR, CS_ITEM_SK, CS_BILL_CUSTOMER_SK, CS_QUANTITY, CS_WHOLESALE_COST, CS_SALES_PRICE]
              HashJoin
                  predicate: =(CS_SOLD_DATE_SK, D_DATE_SK)
                  type: inner
                Filter
                    predicate: IS NULL(CR_ORDER_NUMBER)
                  HashJoin
                      predicate: AND(=(CR_ORDER_NUMBER, CS_ORDER_NUMBER), =(CS_ITEM_SK, CR_ITEM_SK))
                      type: left
                    Exchange
                        distribution: single
                      TableScan
                          table: PUBLIC.CATALOG_SALES
                          fieldNames: [CS_SOLD_DATE_SK, CS_BILL_CUSTOMER_SK, CS_ITEM_SK, CS_ORDER_NUMBER, CS_QUANTITY, CS_WHOLESALE_COST, CS_SALES_PRICE]
                    Exchange
                        distribution: single
                      TableScan
                          table: PUBLIC.CATALOG_RETURNS
                          fieldNames: [CR_ITEM_SK, CR_ORDER_NUMBER]
                Exchange
                    distribution: single
                  TableScan
                      table: PUBLIC.DATE_DIM
                      fieldNames: [D_DATE_SK, D_YEAR]
