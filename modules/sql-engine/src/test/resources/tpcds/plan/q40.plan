Sort
    collation: [W_STATE ASC, I_ITEM_ID ASC]
    fetch: 100
  ColocatedHashAggregate
      fieldNames: [W_STATE, I_ITEM_ID, SALES_BEFORE, SALES_AFTER]
      group: [W_STATE, I_ITEM_ID]
      aggregation: [SUM($f2), SUM($f3)]
    Project
        fieldNames: [W_STATE, I_ITEM_ID, $f2, $f3]
        projection: [W_STATE, I_ITEM_ID, CASE(<(D_DATE, 2000-03-18), -(CS_SALES_PRICE, CASE(IS NOT NULL(CR_REFUNDED_CASH), CAST(CR_REFUNDED_CASH):DECIMAL(12, 2) NOT NULL, 0.00:DECIMAL(12, 2))), 0.00:DECIMAL(13, 2)), CASE(>=(D_DATE, 2000-03-18), -(CS_SALES_PRICE, CASE(IS NOT NULL(CR_REFUNDED_CASH), CAST(CR_REFUNDED_CASH):DECIMAL(12, 2) NOT NULL, 0.00:DECIMAL(12, 2))), 0.00:DECIMAL(13, 2))]
      HashJoin
          predicate: =(I_ITEM_SK, CS_ITEM_SK)
          type: inner
        HashJoin
            predicate: =(CS_SOLD_DATE_SK, D_DATE_SK)
            type: inner
          HashJoin
              predicate: =(CS_WAREHOUSE_SK, W_WAREHOUSE_SK)
              type: inner
            HashJoin
                predicate: AND(=(CS_ORDER_NUMBER, CR_ORDER_NUMBER), =(CS_ITEM_SK, CR_ITEM_SK))
                type: left
              Exchange
                  distribution: single
                TableScan
                    table: PUBLIC.CATALOG_SALES
                    fieldNames: [CS_SOLD_DATE_SK, CS_WAREHOUSE_SK, CS_ITEM_SK, CS_ORDER_NUMBER, CS_SALES_PRICE]
              Exchange
                  distribution: single
                TableScan
                    table: PUBLIC.CATALOG_RETURNS
                    fieldNames: [CR_ITEM_SK, CR_ORDER_NUMBER, CR_REFUNDED_CASH]
            Exchange
                distribution: single
              TableScan
                  table: PUBLIC.WAREHOUSE
                  fieldNames: [W_WAREHOUSE_SK, W_STATE]
          Exchange
              distribution: single
            TableScan
                table: PUBLIC.DATE_DIM
                predicate: SEARCH(D_DATE, Sarg[[2000-02-17..2000-04-17]])
                fieldNames: [D_DATE_SK, D_DATE]
        Exchange
            distribution: single
          TableScan
              table: PUBLIC.ITEM
              predicate: SEARCH(I_CURRENT_PRICE, Sarg[[0.99:DECIMAL(3, 2)..1.49:DECIMAL(3, 2)]]:DECIMAL(3, 2))
              fieldNames: [I_ITEM_SK, I_ITEM_ID, I_CURRENT_PRICE]
