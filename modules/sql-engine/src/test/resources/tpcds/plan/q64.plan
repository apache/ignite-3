Sort(sort0=[$0], sort1=[$1], sort2=[$20], sort3=[$13], sort4=[$16], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC])
  Project(inputs=[0], exprs=[[$2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $15, $16, $17, $18, $35, $36, $37, $31, $34]])
    HashJoin(condition=[AND(=($1, $20), <=($34, $15), =($2, $21), =($3, $22))], joinType=[inner])
      ColocatedHashAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14}], CNT=[COUNT()], S1=[SUM($15)], S2=[SUM($16)], S3=[SUM($17)])
        Project(exprs=[[$45, $42, $55, $56, $7, $8, $9, $10, $12, $13, $14, $15, $47, $3, $5, $39, $40, $41]])
          HashJoin(condition=[AND(=($31, $0), =($38, $1))], joinType=[inner])
            Exchange(distribution=[single])
              TableScan(table=[[PUBLIC, STORE_RETURNS]], requiredColumns=[{2, 9}])
            HashJoin(condition=[=($27, $0)], joinType=[inner])
              Exchange(distribution=[single])
                TableScan(table=[[PUBLIC, DATE_DIM]], requiredColumns=[{0, 6}])
              HashJoin(condition=[=($24, $0)], joinType=[inner])
                Exchange(distribution=[single])
                  TableScan(table=[[PUBLIC, DATE_DIM]], requiredColumns=[{0, 6}])
                HashJoin(condition=[=($30, $48)], joinType=[inner])
                  HashJoin(condition=[=($31, $47)], joinType=[inner])
                    HashJoin(condition=[=($29, $0)], joinType=[inner])
                      Exchange(distribution=[single])
                        TableScan(table=[[PUBLIC, CUSTOMER_ADDRESS]], requiredColumns=[{0, 2, 3, 6, 9}])
                      HashJoin(condition=[=($16, $0)], joinType=[inner])
                        Exchange(distribution=[single])
                          TableScan(table=[[PUBLIC, CUSTOMER_ADDRESS]], requiredColumns=[{0, 2, 3, 6, 9}])
                        HashJoin(condition=[=($1, $36)], joinType=[inner])
                          HashJoin(condition=[=($18, $0)], joinType=[inner])
                            Exchange(distribution=[single])
                              TableScan(table=[[PUBLIC, HOUSEHOLD_DEMOGRAPHICS]], requiredColumns=[{0, 1}])
                            HashJoin(condition=[=($1, $33)], joinType=[inner])
                              HashJoin(condition=[=($8, $0)], joinType=[inner])
                                Exchange(distribution=[single])
                                  TableScan(table=[[PUBLIC, HOUSEHOLD_DEMOGRAPHICS]], requiredColumns=[{0, 1}])
                                HashJoin(condition=[AND(<>($1, $3), =($13, $0))], joinType=[inner])
                                  Exchange(distribution=[single])
                                    TableScan(table=[[PUBLIC, CUSTOMER_DEMOGRAPHICS]], requiredColumns=[{0, 2}])
                                  HashJoin(condition=[=($3, $0)], joinType=[inner])
                                    Exchange(distribution=[single])
                                      TableScan(table=[[PUBLIC, CUSTOMER_DEMOGRAPHICS]], requiredColumns=[{0, 2}])
                                    HashJoin(condition=[=($8, $0)], joinType=[inner])
                                      Exchange(distribution=[single])
                                        TableScan(table=[[PUBLIC, CUSTOMER]], requiredColumns=[{0, 2, 3, 4, 5, 6}])
                                      HashJoin(condition=[=($1, $18)], joinType=[inner])
                                        HashJoin(condition=[=($0, $16)], joinType=[inner])
                                          HashJoin(condition=[=($1, $12)], joinType=[inner])
                                            Exchange(distribution=[single])
                                              TableScan(table=[[PUBLIC, STORE_SALES]], requiredColumns=[{0, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 19}])
                                            Exchange(distribution=[single])
                                              TableScan(table=[[PUBLIC, ITEM]], filters=[AND(OR(=($t2, _UTF-8'azure'), =($t2, _UTF-8'blush'), =($t2, _UTF-8'gainsboro'), =($t2, _UTF-8'hot'), =($t2, _UTF-8'lemon'), =($t2, _UTF-8'misty')), >=(CAST($t1):DECIMAL(10, 2), 80.00), <=(CAST($t1):DECIMAL(10, 2), CAST(+(80, 10)):DECIMAL(10, 2) NOT NULL), >=(CAST($t1):DECIMAL(10, 2), CAST(+(80, 1)):DECIMAL(10, 2) NOT NULL), <=(CAST($t1):DECIMAL(10, 2), CAST(+(80, 15)):DECIMAL(10, 2) NOT NULL))], requiredColumns=[{0, 5, 17, 21}])
                                          Exchange(distribution=[single])
                                            TableScan(table=[[PUBLIC, DATE_DIM]], filters=[=($t1, 1999)], requiredColumns=[{0, 6}])
                                        Filter(condition=[>($1, *(2, $2))])
                                          ReduceHashAggregate(group=[{0}], SALE=[SUM($1)], REFUND=[SUM($2)])
                                            Exchange(distribution=[single])
                                              MapHashAggregate(group=[{0}], SALE=[SUM($1)], REFUND=[SUM($2)])
                                                Project(inputs=[0], exprs=[[$2, +(+($5, $6), $7)]])
                                                  HashJoin(condition=[AND(=($0, $3), =($1, $4))], joinType=[inner])
                                                    TableScan(table=[[PUBLIC, CATALOG_SALES]], requiredColumns=[{15, 17, 25}])
                                                    Exchange(distribution=[affinity[tableId=51, zoneId=51][0, 1]])
                                                      TableScan(table=[[PUBLIC, CATALOG_RETURNS]], requiredColumns=[{2, 16, 23, 24, 25}])
                              Exchange(distribution=[single])
                                TableScan(table=[[PUBLIC, INCOME_BAND]], requiredColumns=[{0}])
                          Exchange(distribution=[single])
                            TableScan(table=[[PUBLIC, INCOME_BAND]], requiredColumns=[{0}])
                    Exchange(distribution=[single])
                      TableScan(table=[[PUBLIC, PROMOTION]], requiredColumns=[{0}])
                  Exchange(distribution=[single])
                    TableScan(table=[[PUBLIC, STORE]], requiredColumns=[{0, 5, 25}])
      ColocatedHashAggregate(group=[{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14}], CNT=[COUNT()], S1=[SUM($15)], S2=[SUM($16)], S3=[SUM($17)])
        Project(exprs=[[$45, $42, $55, $56, $7, $8, $9, $10, $12, $13, $14, $15, $47, $3, $5, $39, $40, $41]])
          HashJoin(condition=[AND(=($31, $0), =($38, $1))], joinType=[inner])
            Exchange(distribution=[single])
              TableScan(table=[[PUBLIC, STORE_RETURNS]], requiredColumns=[{2, 9}])
            HashJoin(condition=[=($27, $0)], joinType=[inner])
              Exchange(distribution=[single])
                TableScan(table=[[PUBLIC, DATE_DIM]], requiredColumns=[{0, 6}])
              HashJoin(condition=[=($24, $0)], joinType=[inner])
                Exchange(distribution=[single])
                  TableScan(table=[[PUBLIC, DATE_DIM]], requiredColumns=[{0, 6}])
                HashJoin(condition=[=($30, $48)], joinType=[inner])
                  HashJoin(condition=[=($31, $47)], joinType=[inner])
                    HashJoin(condition=[=($29, $0)], joinType=[inner])
                      Exchange(distribution=[single])
                        TableScan(table=[[PUBLIC, CUSTOMER_ADDRESS]], requiredColumns=[{0, 2, 3, 6, 9}])
                      HashJoin(condition=[=($16, $0)], joinType=[inner])
                        Exchange(distribution=[single])
                          TableScan(table=[[PUBLIC, CUSTOMER_ADDRESS]], requiredColumns=[{0, 2, 3, 6, 9}])
                        HashJoin(condition=[=($1, $36)], joinType=[inner])
                          HashJoin(condition=[=($18, $0)], joinType=[inner])
                            Exchange(distribution=[single])
                              TableScan(table=[[PUBLIC, HOUSEHOLD_DEMOGRAPHICS]], requiredColumns=[{0, 1}])
                            HashJoin(condition=[=($1, $33)], joinType=[inner])
                              HashJoin(condition=[=($8, $0)], joinType=[inner])
                                Exchange(distribution=[single])
                                  TableScan(table=[[PUBLIC, HOUSEHOLD_DEMOGRAPHICS]], requiredColumns=[{0, 1}])
                                HashJoin(condition=[AND(<>($1, $3), =($13, $0))], joinType=[inner])
                                  Exchange(distribution=[single])
                                    TableScan(table=[[PUBLIC, CUSTOMER_DEMOGRAPHICS]], requiredColumns=[{0, 2}])
                                  HashJoin(condition=[=($3, $0)], joinType=[inner])
                                    Exchange(distribution=[single])
                                      TableScan(table=[[PUBLIC, CUSTOMER_DEMOGRAPHICS]], requiredColumns=[{0, 2}])
                                    HashJoin(condition=[=($8, $0)], joinType=[inner])
                                      Exchange(distribution=[single])
                                        TableScan(table=[[PUBLIC, CUSTOMER]], requiredColumns=[{0, 2, 3, 4, 5, 6}])
                                      HashJoin(condition=[=($1, $18)], joinType=[inner])
                                        HashJoin(condition=[=($0, $16)], joinType=[inner])
                                          HashJoin(condition=[=($1, $12)], joinType=[inner])
                                            Exchange(distribution=[single])
                                              TableScan(table=[[PUBLIC, STORE_SALES]], requiredColumns=[{0, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 19}])
                                            Exchange(distribution=[single])
                                              TableScan(table=[[PUBLIC, ITEM]], filters=[AND(OR(=($t2, _UTF-8'azure'), =($t2, _UTF-8'blush'), =($t2, _UTF-8'gainsboro'), =($t2, _UTF-8'hot'), =($t2, _UTF-8'lemon'), =($t2, _UTF-8'misty')), >=(CAST($t1):DECIMAL(10, 2), 80.00), <=(CAST($t1):DECIMAL(10, 2), CAST(+(80, 10)):DECIMAL(10, 2) NOT NULL), >=(CAST($t1):DECIMAL(10, 2), CAST(+(80, 1)):DECIMAL(10, 2) NOT NULL), <=(CAST($t1):DECIMAL(10, 2), CAST(+(80, 15)):DECIMAL(10, 2) NOT NULL))], requiredColumns=[{0, 5, 17, 21}])
                                          Exchange(distribution=[single])
                                            TableScan(table=[[PUBLIC, DATE_DIM]], filters=[=($t1, +(1999, 1))], requiredColumns=[{0, 6}])
                                        Filter(condition=[>($1, *(2, $2))])
                                          ReduceHashAggregate(group=[{0}], SALE=[SUM($1)], REFUND=[SUM($2)])
                                            Exchange(distribution=[single])
                                              MapHashAggregate(group=[{0}], SALE=[SUM($1)], REFUND=[SUM($2)])
                                                Project(inputs=[0], exprs=[[$2, +(+($5, $6), $7)]])
                                                  HashJoin(condition=[AND(=($0, $3), =($1, $4))], joinType=[inner])
                                                    TableScan(table=[[PUBLIC, CATALOG_SALES]], requiredColumns=[{15, 17, 25}])
                                                    Exchange(distribution=[affinity[tableId=51, zoneId=51][0, 1]])
                                                      TableScan(table=[[PUBLIC, CATALOG_RETURNS]], requiredColumns=[{2, 16, 23, 24, 25}])
                              Exchange(distribution=[single])
                                TableScan(table=[[PUBLIC, INCOME_BAND]], requiredColumns=[{0}])
                          Exchange(distribution=[single])
                            TableScan(table=[[PUBLIC, INCOME_BAND]], requiredColumns=[{0}])
                    Exchange(distribution=[single])
                      TableScan(table=[[PUBLIC, PROMOTION]], requiredColumns=[{0}])
                  Exchange(distribution=[single])
                    TableScan(table=[[PUBLIC, STORE]], requiredColumns=[{0, 5, 25}])
