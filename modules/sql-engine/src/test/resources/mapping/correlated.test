N0
SELECT (SELECT count(*) FROM ct_n1) FROM t_n1
---
Fragment#0 root
  nodes: [N0]
  remoteFragments: [1]
  tree:
    IgniteReceiver(sourceFragment=1, exchange=1, distribution=single)

Fragment#2
  target:
    nodes: [N1]
    sources: [-1, 2, 4]
    assignments: [N1:1]
  tables: [T_N1]
  nodes: [N1]
  tree:
    IgniteSender(targetFragment=1, exchange=2, distribution=single)
      IgniteTableScan(name=PUBLIC.T_N1, source=3, distribution=random)

Fragment#1
  target:
    nodes: [N0]
    sources: [-1, 1]
  tables: [CT_N1]
  nodes: [N1]
  remoteFragments: [2]
  tree:
    IgniteSender(targetFragment=0, exchange=1, distribution=single)
      IgniteProject
        IgniteNestedLoopJoin
          IgniteReceiver(sourceFragment=2, exchange=2, distribution=single)
          IgniteColocatedHashAggregate
            IgniteTableScan(name=PUBLIC.CT_N1, source=4, distribution=single)
---

N1
SELECT (SELECT count(*) FROM ct_n1) FROM t_n1
---
Fragment#0 root
  tables: [CT_N1]
  nodes: [N1]
  remoteFragments: [1]
  tree:
    IgniteProject
      IgniteNestedLoopJoin
        IgniteReceiver(sourceFragment=1, exchange=1, distribution=single)
        IgniteColocatedHashAggregate
          IgniteTableScan(name=PUBLIC.CT_N1, source=2, distribution=single)

Fragment#1
  target:
    nodes: [N1]
    sources: [-1, 1, 2]
    assignments: [N1:1]
  tables: [T_N1]
  nodes: [N1]
  tree:
    IgniteSender(targetFragment=0, exchange=1, distribution=single)
      IgniteTableScan(name=PUBLIC.T_N1, source=3, distribution=random)
---

N0
SELECT (SELECT count(*) FROM ct_n1) FROM t_n2
---
Fragment#0 root
  nodes: [N0]
  remoteFragments: [1]
  tree:
    IgniteReceiver(sourceFragment=1, exchange=1, distribution=single)

Fragment#2
  target:
    nodes: [N1]
    sources: [-1, 2, 4]
    assignments: [N1:1]
  tables: [T_N2]
  nodes: [N2]
  tree:
    IgniteSender(targetFragment=1, exchange=2, distribution=single)
      IgniteTableScan(name=PUBLIC.T_N2, source=3, distribution=random)

Fragment#1
  target:
    nodes: [N0]
    sources: [-1, 1]
  tables: [CT_N1]
  nodes: [N1]
  remoteFragments: [2]
  tree:
    IgniteSender(targetFragment=0, exchange=1, distribution=single)
      IgniteProject
        IgniteNestedLoopJoin
          IgniteReceiver(sourceFragment=2, exchange=2, distribution=single)
          IgniteColocatedHashAggregate
            IgniteTableScan(name=PUBLIC.CT_N1, source=4, distribution=single)
---

N1
SELECT (SELECT count(*) FROM ct_n1) FROM t_n2
---
Fragment#0 root
  tables: [CT_N1]
  nodes: [N1]
  remoteFragments: [1]
  tree:
    IgniteProject
      IgniteNestedLoopJoin
        IgniteReceiver(sourceFragment=1, exchange=1, distribution=single)
        IgniteColocatedHashAggregate
          IgniteTableScan(name=PUBLIC.CT_N1, source=2, distribution=single)

Fragment#1
  target:
    nodes: [N1]
    sources: [-1, 1, 2]
    assignments: [N1:1]
  tables: [T_N2]
  nodes: [N2]
  tree:
    IgniteSender(targetFragment=0, exchange=1, distribution=single)
      IgniteTableScan(name=PUBLIC.T_N2, source=3, distribution=random)
---

N0
SELECT t.c1 FROM t_n1 t JOIN table(system_range(1, 50)) as r ON t.id = r.x WHERE mod(r.x, 10) = 0
---
Fragment#0 root
  nodes: [N0]
  remoteFragments: [1]
  tree:
    IgniteProject
      IgniteMergeJoin
        IgniteReceiver(sourceFragment=1, exchange=1, distribution=single)
        IgniteSort
          IgniteFilter
            IgniteTableFunctionScan(source=-1, distribution=single)

Fragment#1
  target:
    nodes: [N0]
    sources: [-1, 1]
  tables: [T_N1]
  nodes: [N1]
  tree:
    IgniteSender(targetFragment=0, exchange=1, distribution=single)
      IgniteSort
        IgniteTableScan(name=PUBLIC.T_N1, source=2, distribution=random)
---

N0
SELECT t.c1 FROM ct_n1 t WHERE t.c1 < 5 AND
EXISTS (SELECT x FROM table(system_range(t.c1, t.c2)) WHERE mod(x, 2) = 0)
---
Fragment#0 root
  nodes: [N0]
  remoteFragments: [1]
  tree:
    IgniteReceiver(sourceFragment=1, exchange=1, distribution=single)

Fragment#1
  target:
    nodes: [N0]
    sources: [-1, 1]
  tables: [CT_N1]
  nodes: [N1]
  tree:
    IgniteSender(targetFragment=0, exchange=1, distribution=single)
      IgniteProject
        IgniteFilter
          IgniteCorrelatedNestedLoopJoin
            IgniteTableScan(name=PUBLIC.CT_N1, source=2, distribution=single)
            IgniteColocatedHashAggregate
              IgniteProject
                IgniteFilter
                  IgniteTableFunctionScan(source=-1, distribution=single)
---

N0
SELECT t.c1 FROM t_n1 t WHERE t.c1 < 5 AND
EXISTS (SELECT x FROM table(system_range(t.c1, t.c2)) WHERE mod(x, 2) = 0)
---
Fragment#0 root
  nodes: [N0]
  remoteFragments: [1]
  tree:
    IgniteProject
      IgniteFilter
        IgniteCorrelatedNestedLoopJoin
          IgniteReceiver(sourceFragment=1, exchange=1, distribution=single)
          IgniteColocatedHashAggregate
            IgniteProject
              IgniteFilter
                IgniteTableFunctionScan(source=-1, distribution=single)

Fragment#1
  target:
    nodes: [N0]
    sources: [-1, 1]
  tables: [T_N1]
  nodes: [N1]
  tree:
    IgniteSender(targetFragment=0, exchange=1, distribution=single)
      IgniteTableScan(name=PUBLIC.T_N1, source=2, distribution=affinity[table: T_N1])
---
