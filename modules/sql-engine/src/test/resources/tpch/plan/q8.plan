Sort(sort0=[$0], dir0=[ASC])
  Project(inputs=[0], exprs=[[/($1, $2)]])
    ColocatedHashAggregate(group=[{0}], agg#0=[SUM($1)], agg#1=[SUM($2)])
      Project(exprs=[[EXTRACT(FLAG(YEAR), $7), CASE(=($19, _UTF-8'BRAZIL'), *($3, -(1, $4)), 0.0000:DECIMAL(31, 4)), *($3, -(1, $4))]])
        HashJoin(condition=[=($16, $2)], joinType=[inner])
          HashJoin(condition=[=($14, $1)], joinType=[inner])
            HashJoin(condition=[=($0, $5)], joinType=[inner])
              Exchange(distribution=[single])
                TableScan(table=[[PUBLIC, LINEITEM]], requiredColumns=[{0, 1, 2, 5, 6}])
              HashJoin(condition=[=($1, $3)], joinType=[inner])
                Exchange(distribution=[single])
                  TableScan(table=[[PUBLIC, ORDERS]], filters=[AND(>=($t2, 1995-01-01), <=($t2, 1996-12-31))], requiredColumns=[{0, 1, 4}])
                HashJoin(condition=[=($1, $2)], joinType=[inner])
                  Exchange(distribution=[single])
                    TableScan(table=[[PUBLIC, CUSTOMER]], requiredColumns=[{0, 3}])
                  NestedLoopJoin(condition=[=($1, $2)], joinType=[inner])
                    Exchange(distribution=[single])
                      TableScan(table=[[PUBLIC, NATION]], requiredColumns=[{0, 2}])
                    Exchange(distribution=[single])
                      TableScan(table=[[PUBLIC, REGION]], filters=[=($t1, _UTF-8'AMERICA')], requiredColumns=[{0, 1}])
            Exchange(distribution=[single])
              TableScan(table=[[PUBLIC, PART]], filters=[=($t1, _UTF-8'ECONOMY ANODIZED STEEL')], requiredColumns=[{0, 4}])
          HashJoin(condition=[=($1, $2)], joinType=[inner])
            Exchange(distribution=[single])
              TableScan(table=[[PUBLIC, SUPPLIER]], requiredColumns=[{0, 3}])
            Exchange(distribution=[single])
              TableScan(table=[[PUBLIC, NATION]], requiredColumns=[{0, 1}])
