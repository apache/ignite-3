Sort(sort0=[$0], sort1=[$1], sort2=[$2], dir0=[ASC], dir1=[ASC], dir2=[ASC])
  ColocatedHashAggregate(group=[{0, 1, 2}], REVENUE=[SUM($3)])
    Project(exprs=[[$14, $10, EXTRACT(FLAG(YEAR), $4), *($2, -(1, $3))]])
      HashJoin(condition=[AND(=($11, $1), OR(=($10, _UTF-8'GERMANY'), =($14, _UTF-8'GERMANY')), OR(=($14, _UTF-8'FRANCE'), =($10, _UTF-8'FRANCE')))], joinType=[inner])
        HashJoin(condition=[=($5, $0)], joinType=[inner])
          Exchange(distribution=[single])
            TableScan(table=[[PUBLIC, LINEITEM]], filters=[AND(>=($t4, 1995-01-01), <=($t4, 1996-12-31))], requiredColumns=[{0, 2, 5, 6, 10}])
          HashJoin(condition=[=($2, $1)], joinType=[inner])
            Exchange(distribution=[single])
              TableScan(table=[[PUBLIC, ORDERS]], requiredColumns=[{0, 1}])
            HashJoin(condition=[=($1, $2)], joinType=[inner])
              Exchange(distribution=[single])
                TableScan(table=[[PUBLIC, CUSTOMER]], requiredColumns=[{0, 3}])
              Exchange(distribution=[single])
                TableScan(table=[[PUBLIC, NATION]], filters=[OR(=($t1, _UTF-8'FRANCE'), =($t1, _UTF-8'GERMANY'))], requiredColumns=[{0, 1}])
        HashJoin(condition=[=($1, $2)], joinType=[inner])
          Exchange(distribution=[single])
            TableScan(table=[[PUBLIC, SUPPLIER]], requiredColumns=[{0, 3}])
          Exchange(distribution=[single])
            TableScan(table=[[PUBLIC, NATION]], filters=[OR(=($t1, _UTF-8'FRANCE'), =($t1, _UTF-8'GERMANY'))], requiredColumns=[{0, 1}])
